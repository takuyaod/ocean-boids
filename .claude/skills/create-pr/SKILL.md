# プルリクエスト作成スキル

現在のブランチからプルリクエストを作成します。クローズする issue を指定できます。

## 使い方

```
/create-pr [issue番号]
```

- `issue番号` を指定するとその issue をクローズする PR を作成します
- 省略した場合は issue なしで PR を作成します

## 手順

1. `$ARGUMENTS` から issue 番号を取得する（任意）
2. 現在のブランチ名とコミット履歴を確認する
3. issue が指定された場合は内容を取得してタイトル・本文の参考にする
4. PR のタイトルと本文をまとめる
5. PR を作成してユーザーに URL を伝える

## 実行

### 現在のブランチ確認

```bash
git branch --show-current
```

main / master ブランチの場合は作業ブランチへ切り替えるよう伝えて中断してください。

### コミット履歴の確認

```bash
git log main..HEAD --oneline
```

コミットが0件の場合は PR を作成するものがない旨を伝えて中断してください。

### issue 情報の取得（指定された場合）

```bash
gh issue view <issue番号> --json number,title,body
```

### PR タイトルと本文の生成ルール

**タイトル**:
- issue が指定されている場合: issue のタイトルをそのまま使うか、コミット内容に合わせて調整する
- issue がない場合: コミット履歴から内容を要約する

**本文**:
- issue が指定されている場合は本文末尾に以下を追加する:
  ```
  Closes #<issue番号>
  ```
- 変更の概要をコミット履歴から自動生成する
- 本文テンプレート:
  ```
  ## 概要

  <変更内容の簡潔な説明>

  ## 変更点

  <コミット一覧や主な変更を箇条書き>

  Closes #<issue番号>  ← issue が指定された場合のみ
  ```

### PR 作成

```bash
gh pr create --title "<タイトル>" --body "<本文>" --base main
```

### 完了報告

- 作成した PR の URL を表示する
- クローズ対象の issue 番号も併せて表示する（指定された場合）
